{
  "name": "image_analysis",
  "description": "Perform targeted analysis on images or PDFs via file URL. Actions: 'ocr' (text), 'handwriting' (handwritten text), 'classify' (objects), 'detect_faces', 'detect_document', 'scan_document' (OCR with perspective correction), 'compare' (multi-image), 'pdf_extract_text', 'pdf_ocr', 'pdf_page_count'. Only file:// URLs supported.",
  "category": "utility",
  "priority": 3,
  "requiresConfirmation": false,
  "platforms": ["ios", "macos"],
  "permissions": ["photo_library"],
  "triggers": [
    "analyze image",
    "read text in image",
    "OCR",
    "what's in this image",
    "what's in this photo",
    "identify objects",
    "detect faces",
    "how many people",
    "scan document",
    "extract text",
    "summarize PDF",
    "read PDF",
    "what's in this PDF",
    "extract text from PDF",
    "how many pages",
    "compare images",
    "handwriting recognition"
  ],
  "parameters": {
    "type": "object",
    "properties": {
      "action": {
        "type": "string",
        "enum": ["ocr", "handwriting", "classify", "detect_faces", "detect_document", "scan_document", "compare", "pdf_extract_text", "pdf_ocr", "pdf_page_count"],
        "description": "Analysis type: 'ocr' for printed text, 'handwriting' for handwritten text, 'classify' for objects, 'detect_faces' for faces, 'detect_document' for boundaries, 'scan_document' for document OCR with perspective correction, 'compare' for multi-image comparison, 'pdf_extract_text' for searchable PDFs, 'pdf_ocr' for scanned PDFs, 'pdf_page_count' for page count"
      },
      "imageURL": {
        "type": "string",
        "format": "uri",
        "description": "File URL to the image (file:// scheme only)"
      },
      "imageURLs": {
        "type": "array",
        "items": { "type": "string" },
        "description": "Array of file URLs for 'compare' action (2-5 images)"
      },
      "pdfURL": {
        "type": "string",
        "format": "uri",
        "description": "File URL to the PDF (file:// scheme only)"
      },
      "pageRange": {
        "type": "string",
        "description": "Page range for PDF operations, e.g., '1-5' or '1,3,5' (optional, defaults to all pages)"
      },
      "comparisonPrompt": {
        "type": "string",
        "description": "Optional prompt for 'compare' action (e.g., 'What changed between these images?')"
      }
    },
    "required": ["action"]
  },
  "examples": [
    {
      "description": "Extract text from an image (OCR)",
      "input": "What text is in this image?",
      "call": {
        "action": "ocr",
        "imageURL": "file:///Users/user/Documents/receipt.jpg"
      },
      "output": "Recognized text:\n1. Meeting at 3pm\n2. Call John\n3. Buy groceries"
    },
    {
      "description": "Recognize handwritten notes",
      "input": "Read the handwriting in this note",
      "call": {
        "action": "handwriting",
        "imageURL": "file:///Users/user/Documents/handwritten_note.jpg"
      },
      "output": "Recognized handwriting:\nDear Mom, Thanks for everything..."
    },
    {
      "description": "Identify objects in a photo",
      "input": "What's in this photo?",
      "call": {
        "action": "classify",
        "imageURL": "file:///Users/user/Photos/dog.jpg"
      },
      "output": "Image classification:\n- golden retriever (92.5%)\n- dog (89.3%)\n- domestic animal (85.1%)"
    },
    {
      "description": "Count faces in a group photo",
      "input": "How many people are in this picture?",
      "call": {
        "action": "detect_faces",
        "imageURL": "file:///Users/user/Photos/family.jpg"
      },
      "output": "Found 4 faces in the image"
    },
    {
      "description": "Compare two images",
      "input": "What changed between these two photos?",
      "call": {
        "action": "compare",
        "imageURLs": ["file:///Users/user/before.jpg", "file:///Users/user/after.jpg"],
        "comparisonPrompt": "What changed between these images?"
      },
      "output": "Comparison of 2 images:\n- Text content differs between images\n- Face count: 2 in first, 3 in second"
    },
    {
      "description": "OCR a scanned PDF document",
      "input": "Read this scanned document",
      "call": {
        "action": "pdf_ocr",
        "pdfURL": "file:///Users/user/Documents/scanned_contract.pdf"
      },
      "output": "OCR completed on 5 pages:\n\n--- Page 1 ---\nSERVICE AGREEMENT\n\nThis agreement is entered into..."
    },
    {
      "description": "Extract specific pages from PDF",
      "input": "Get the text from pages 1-3 of this PDF",
      "call": {
        "action": "pdf_extract_text",
        "pdfURL": "file:///Users/user/Documents/report.pdf",
        "pageRange": "1-3"
      },
      "output": "Extracted text from pages 1-3:\n\nExecutive Summary\n\nThis report outlines..."
    }
  ],
  "notes": [
    "Only file:// URLs are supported (no base64 or remote URLs)",
    "For user-attached images, pre-processing happens before the LLM call via ImagePreProcessor",
    "This tool is for targeted follow-up operations on files (e.g., 'get face coordinates')",
    "pdf_extract_text is fast for searchable PDFs (text-based)",
    "pdf_ocr renders pages as images and runs OCR (for scanned documents)",
    "pageRange is optional, supports '1-5' or '1,3,5' formats",
    "PDF text is truncated at ~15,000 characters; OCR limited to 10 pages",
    "handwriting and scan_document actions require iOS/macOS 26.0+",
    "Classification returns top 5 labels with confidence scores"
  ]
}

